#include "Extensions/Hack Installation.txt"
#include "Extensions/6CDefinitions.txt"

#include "Movement Arrow EA.txt"
#include "FE8-Buy Units/FE8-Buy Unit EA.txt"

PUSH

//Set guard tile ai after moving and don't set bit 2 of status word if wagon
ORG $18750
callHack_r3(End_Unit_Action)

//When player phase ends and the 'has moved' bits are being unset, write guard tile ai
ORG $1882C
callHack_r0(End_Phase_Set_Guard)

//Everyone can access Supply
ORG $23F64
SHORT 0x2001 0x4770

//Make sure class+char bases are >=0
ORG $17E64
callHack_r3(No_Negative_Stats)

//Make NPC phase not appear (set eligible unit count to 0, basically)
ORG $24CEC
jumpToHack(No_Eligible_NPCs)

//Really friggin' tired of no$ crashing when trying to decompress bad data, so here's a fix
ORG $12F50
jumpToHack(Decompress_Fix)

//Make items purchased in a shop automatically go into storage
//ORG $B4656
//SHORT 0x46C0

//Disable being able to give to the convoy
//ORG $9DD08
//SHORT 0xE060
//ORG $9D679 //color of 'Give' option
//BYTE 0xE0

//Determines whether a unit can give items to the convoy (currently only thieves can)
//ORG $9DD08
//jumpToHack(Can_Give_To_Convoy)

//Dropped items go directly into the convoy
//ORG $17948
//jumpToHack(Send_Drops_To_Convoy)
//However, initalizing a unit's inventory *doesn't* go to the convoy
//ORG $17DD8
//BL(0x17950)
//ORG 0x17950
//jumpToHack(Set_Unit_Inventory)

//Seed the initial random numbers with the frame count when pressing Start
//ORG $C637C
//jumpToHack(Seed_Random_Numbers)

//Make random char ids for units
//ORG $F6A0
//callHack_r3(Random_Char_ID)

POP

ALIGN 4
End_Unit_Action:
#incbin "End_Unit_Action.dmp"

ALIGN 4
End_Phase_Set_Guard:
#incbin "End_Phase_Set_Guard.dmp"

ALIGN 4
No_Negative_Stats:
#incbin "No_Negative_Stats.dmp"

ALIGN 4
No_Eligible_NPCs:
#incbin "No_Eligible_NPCs.dmp"

ALIGN 4
Decompress_Fix:
#incbin "Decompress_Fix.dmp"

/*
ALIGN 4
Can_Give_To_Convoy:
#incbin "Can_Give_To_Convoy.dmp"
POIN CanGiveToConvoyList

CanGiveToConvoyList:
BYTE Tent 0

ALIGN 4
Send_Drops_To_Convoy:
#incbin "Send_Drops_To_Convoy.dmp"

ALIGN 4
Set_Unit_Inventory:
#incbin "Set_Unit_Inventory.dmp"

ALIGN 4
UntouchableTile:
#incbin "Untouchable_Tile.dmp"

ALIGN 4
Seed_Random_Numbers:
#incbin "Seed_Random_Numbers.dmp"

ALIGN 4
Random_Char_ID:
#incbin "Random_Char_ID.dmp"
*/
